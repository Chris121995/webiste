<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Games</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- Füge hier die CSS-Dateien für jedes Spiel ein -->
    <link rel="stylesheet" href="schach.css"> 

    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f0f0f0;
        }
        .tab {
            display: none;
        }
        .tab-buttons button {
            padding: 10px 20px;
            margin: 10px;
            border: none;
            background-color: #007BFF;
            color: white;
            cursor: pointer;
        }
        .tab-buttons button.active {
            background-color: #0056b3;
        }
        canvas {
            border: 3px solid black;
            background-color: #ddd;
            display: inline-block;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <header>
        <h1>Games</h1>
        <nav>
            <ul>
                <li><a href="index.html">Über mich</a></li>
                <li><a href="Zertifikate.html">Lebenslauf & Zertifikate</a></li>
                <li><a href="kontakt.html">Kontakt</a></li>
                <li><a href="spiele.html">Games<a/></li>
            </ul>
        </nav>
    </header>

    <h1>Schach gegen KI</h1>
    

    <!-- Schach Tab -->
    <div id="chessboard" style="width: 400px; margin: 0 auto;"></div> <!-- Schachbrett -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.12.0/chess.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/nmrugg/stockfish.js/stockfish.js"></script>
    <script src="script.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chessboardjs/1.0.0/chessboard-1.0.0.min.css"/>
    
    <script>
        const boardElement = document.getElementById('chessboard');
        const game = new Chess(); // Initialisiert das Schachspiel mit chess.js
    
        // Initialisiere Stockfish über WebAssembly
        const stockfish = Stockfish();
    
        // Erstelle das Schachbrett
        const board = Chessboard('chessboard', {
            draggable: true,
            position: 'start',
            onDrop: handleMove, // Diese Funktion wird aufgerufen, wenn ein Zug gemacht wird
        });
    
        // Funktion, um einen Zug zu verarbeiten
        function handleMove(source, target) {
            const move = game.move({
                from: source,
                to: target,
                promotion: 'q' // Automatische Beförderung zur Dame
            });
    
            // Ungültigen Zug zurücksetzen
            if (move === null) return 'snapback';
    
            // Zug der KI (Stockfish)
            setTimeout(makeAIMove, 250);
        }
    
        // KI bewegt sich
        function makeAIMove() {
            const possibleMoves = game.moves();
            if (possibleMoves.length === 0) return; // Spielende
    
            // Fordere Stockfish auf, den besten Zug zu finden
            stockfish.postMessage('position fen ' + game.fen());
            stockfish.postMessage('go depth 10'); // Tiefe für den AI-Zug
    
            // Warte auf die Antwort von Stockfish
            stockfish.onmessage = function (event) {
                const move = event.data;
    
                // Wenn Stockfish den besten Zug geschickt hat
                if (move.indexOf('bestmove') === 0) {
                    const aiMove = move.split(' ')[1];
                    game.uci(aiMove); // Führe den Zug aus
                    board.position(game.fen()); // Aktualisiere das Schachbrett
                }
            };
        }
    </script>


</body>
</html>
